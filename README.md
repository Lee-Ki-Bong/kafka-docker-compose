[참고]테스트 중 발생한 `TimeoutException` 오류는 메시지를 처리하는 동안 타임아웃이 발생했다는 것을 나타내지만, 전체적인 테스트 결과에는 영향을 미치지 않는다.

### 전체 스크립트 요약

1. **스크립트 초기화**:
   - 스크립트가 실행 중 오류가 발생하면 즉시 종료(`set -e`).
   - 첫 번째 인자를 `file` 변수에 저장.

2. **오류 처리 함수**:
   - 오류 발생 시 `error_handler` 함수가 실행되어 현재 실행 중인 Docker Compose 스택을 종료.
   - 실행 중인 명령어와 오류가 발생한 라인 번호를 출력.

3. **컨테이너 상태 확인 함수**:
   - `all_great` 함수는 실행 중인 컨테이너의 개수를 확인.
   - 실행 중인 컨테이너가 예상과 다르면 컨테이너 목록과 로그를 출력하고 스크립트를 종료.

4. **Kafka 테스트 함수**:
   - `kafka_tests` 함수는 Kafka 클러스터를 테스트.
   - Kafka 토픽을 생성하고, 메시지를 전송한 후 수신된 메시지의 개수를 확인.
   - 메시지의 개수가 예상과 다르면 스크립트를 종료.

5. **스택 생성 및 테스트**:
   - 기존 스택을 종료하고 새로운 스택을 백그라운드에서 실행.
   - 컨테이너가 모두 실행될 때까지 대기 후 상태 확인.
   - Kafka 테스트를 수행하고 상태를 다시 확인.
   - 모든 테스트가 성공하면 스택을 종료하고 성공 메시지를 출력.

### 실행 방법

스크립트를 실행하여 Docker Compose 환경을 테스트하는 방법은 다음과 같습니다:

```bash
chmod +x kafka-test.sh  # 스크립트에 실행 권한 부여
./kafka-test.sh docker-compose.yml 2  # docker-compose.yml 파일과 실행 중인 컨테이너 수 2개를 인수로 전달하여 실행
```

이제 이 스크립트를 사용하여 Kafka와 ZooKeeper 환경을 Docker Compose를 통해 자동으로 설정하고 테스트할 수 있습니다. 테스트가 성공했음을 알리는 메시지를 통해 전체 프로세스가 정상적으로 완료되었음을 확인할 수 있습니다.

